{"version":3,"file":"index-C6horIJp.js","sources":["../../../app/administration/src/component/form/aggro-entity-listing/aggro-entity-listing.html.twig","../../../app/administration/src/component/form/aggro-entity-listing/index.js"],"sourcesContent":["\n\n{% block sw_data_grid_settings_additional_settings_inner %}\n    {% parent %}\n    <sw-multi-select\n        v-if=\"groupableColumns.length > 0\"\n        :label=\"$t('sw-data-grid.settings.groupBy')\"\n        :options=\"groupableColumns\"\n        label-property=\"label\"\n        value-property=\"property\"\n        v-model:value=\"currentGroupBy\"\n    />\n{% endblock %}\n\n\n{% block sw_data_grid_header_columns_label %}\n    <template v-else>\n        <span v-if=\"isSumColumn(column)\" class=\"sw-data-grid__column-actions-sum\">\n            &sum;\n        </span>\n        {{ $te((column.label ?? 'undefined')) ? $tc(column.label) : column.label }}\n    </template>\n{% endblock %}\n\n{% block sw_data_grid_column_actions %}\n    {% parent %}\n\n    <sw-icon\n            v-if=\"isGroupedColumn(column)\"\n            name=\"regular-shuffle\"\n            size=\"14px\"\n    >\n    </sw-icon>\n{% endblock %}\n\n{% block sw_data_grid_body_row %}\n    <template\n        v-for=\"(item, itemIndex) in records\"\n        :key=\"item.id\">\n    <tr\n\n            class=\"sw-data-grid__row\"\n            :class=\"getRowClasses(item, itemIndex)\"\n    >\n\n        {% block sw_data_grid_body_cell_selection %}\n            <td\n                    v-if=\"showSelection\"\n                    class=\"sw-data-grid__cell sw-data-grid__cell--selection\"\n            >\n                <slot\n                        name=\"selection-content\"\n                        v-bind=\"{ item, isSelected, isRecordSelectable, selectItem, itemIdentifierProperty }\"\n                >\n                    {% block sw_data_grid_body_cell_selection_content %}\n                        <div class=\"sw-data-grid__cell-content\">\n                            {% block sw_data_grid_select_item_checkbox %}\n                                <sw-checkbox-field\n                                        :aria-label=\"$tc('global.sw-data-grid.labelSelected')\"\n                                        :disabled=\"!isRecordSelectable(item)\"\n                                        :value=\"isSelected(item[itemIdentifierProperty])\"\n                                        @update:value=\"selectItem($event, item)\"\n                                />\n                            {% endblock %}\n                        </div>\n                    {% endblock %}\n                </slot>\n            </td>\n        {% endblock %}\n\n        {% block sw_data_grid_body_columns %}\n            <td\n                    v-for=\"(column, columnIndex) in currentVisibleColumns\"\n                    :key=\"`${item.id}-${columnIndex}`\"\n                    class=\"sw-data-grid__cell\"\n                    :class=\"getCellClasses(column)\"\n                    role=\"gridcell\"\n                    @dblclick=\"onDbClickCell(item)\"\n            >\n                <sw-provide :aria-label=\"column.label\">\n\n                    {% block sw_data_grid_body_columns_content %}\n                        <div class=\"sw-data-grid__cell-content\">\n\n                            {% block sw_data_grid_preview_slot %}\n                                <slot\n                                        v-if=\"previews && !isInlineEdit(item)\"\n                                        :name=\"`preview-${column.property}`\"\n                                        v-bind=\"{ item, column, compact }\"\n                                ></slot>\n                            {% endblock %}\n\n                            {% block sw_data_grid_columns_slot %}\n                                <slot\n                                        :name=\"`column-${column.property}`\"\n                                        v-bind=\"{ item, itemIndex, column, columnIndex, compact, isInlineEdit: (isInlineEdit(item) && column.hasOwnProperty('inlineEdit')), selectItem }\"\n                                >\n                                    <template v-if=\"column.inlineEdit === 'boolean'\">\n                                        {% block sw_data_grid_columns_boolean %}\n                                            <sw-data-grid-column-boolean\n                                                    v-model:value=\"item[column.property]\"\n                                                    :is-inline-edit=\"isInlineEdit(item) && column.hasOwnProperty('inlineEdit')\"\n                                            />\n                                        {% endblock %}\n                                    </template>\n                                    <template v-else>\n                                        {% block sw_data_grid_columns_inline_edit %}\n                                            <template v-if=\"isInlineEdit(item) && column.hasOwnProperty('inlineEdit')\">\n                                                {% block sw_data_grid_columns_render_inline_edit %}\n                                                    <sw-data-grid-inline-edit\n                                                            v-model:value=\"item[column.property]\"\n                                                            :column=\"column\"\n                                                            :compact=\"compact\"\n                                                    />\n                                                {% endblock %}\n                                            </template>\n                                        {% endblock %}\n\n                                        {% block sw_data_grid_columns_value %}\n                                            <template v-else>\n                                                {% block sw_data_grid_columns_render_router_link %}\n                                                    <router-link\n                                                            v-if=\"column.routerLink\"\n                                                            class=\"sw-data-grid__cell-value\"\n                                                            :to=\"{ name: column.routerLink, params: { id: item.id } }\"\n                                                    >\n                                                        <component\n                                                                v-if=\"column.component\"\n                                                                :is=\"column.component\"\n                                                                :item=\"item\"\n                                                                :column=\"column\"\n                                                                :value=\"renderColumn(item, column)\"\n                                                        />\n                                                        <span v-else>\n                                                            {{ renderColumn(item, column) }}\n                                                        </span>\n                                                    </router-link>\n                                                {% endblock %}\n                                                {% block sw_data_grid_columns_render_value %}\n                                                    <span\n                                                            v-else\n                                                            class=\"sw-data-grid__cell-value\"\n                                                    >\n                                                        <sw-button\n                                                                v-if=\"isGroupedColumn(column)\"\n                                                                size=\"x-small\"\n                                                                variant=\"context\"\n                                                                @click=\"toggleItemExpand(item, column)\"\n                                                        >\n                                                            <sw-icon :name=\"isItemColumnExpanded(item, column) ? 'regular-minus-square' : 'regular-plus-square'\" small></sw-icon>\n                                                        </sw-button>\n\n                                                        <component\n                                                                v-if=\"column.component\"\n                                                                :is=\"column.component\"\n                                                                :item=\"item\"\n                                                                :column=\"column\"\n                                                                :value=\"renderColumn(item, column)\"\n                                                        />\n                                                        <span v-else>\n                                                            {{ renderColumn(item, column) }}\n                                                        </span>\n                                                    </span>\n                                                {% endblock %}\n                                            </template>\n                                        {% endblock %}\n                                    </template>\n                                </slot>\n                            {% endblock %}\n                        </div>\n                    {% endblock %}\n                </sw-provide>\n            </td>\n        {% endblock %}\n\n        {% block sw_data_grid_body_cell_spacer %}\n            <td\n                    v-if=\"hasResizeColumns\"\n                    aria-hidden=\"true\"\n                    class=\"sw-data-grid__cell sw-data-grid__cell-spacer\"\n                    @dblclick=\"onDbClickCell(item)\"\n            >\n                <div class=\"sw-data-grid__cell-content\"></div>\n            </td>\n        {% endblock %}\n\n        {% block sw_data_grid_body_cell_actions %}\n            <td\n                    v-if=\"showActions\"\n                    class=\"sw-data-grid__cell sw-data-grid__cell--actions\"\n            >\n                {% block sw_data_grid_body_cell_actions_content %}\n                    <div class=\"sw-data-grid__cell-content\">\n\n                        {% block sw_data_grid_inline_edit_actions %}\n                            <template v-if=\"isInlineEditActive && currentInlineEditId === item[itemIdentifierProperty]\">\n\n                                {% block sw_data_grid_inline_edit_actions_cancel %}\n                                    <sw-button\n                                            class=\"sw-data-grid__inline-edit-cancel\"\n                                            size=\"x-small\"\n                                            :title=\"$tc('global.default.cancel')\"\n                                            :aria-label=\"$tc('global.default.cancel')\"\n                                            square\n                                            @click=\"onClickCancelInlineEdit(item)\"\n                                    >\n                                        {% block sw_data_grid_inline_edit_actions_cancel_icon %}\n                                            <sw-icon name=\"regular-times-xs\" />\n                                        {% endblock %}\n                                    </sw-button>\n                                {% endblock %}\n\n                                {% block sw_data_grid_inline_edit_actions_save %}\n                                    <sw-button\n                                            class=\"sw-data-grid__inline-edit-save\"\n                                            variant=\"primary\"\n                                            size=\"x-small\"\n                                            :title=\"$tc('global.default.save')\"\n                                            :aria-label=\"$tc('global.default.save')\"\n                                            square\n                                            @click=\"onClickSaveInlineEdit(item)\"\n                                    >\n                                        {% block sw_data_grid_inline_edit_actions_save_icon %}\n                                            <sw-icon\n                                                    name=\"regular-checkmark-xxs\"\n                                            />\n                                        {% endblock %}\n                                    </sw-button>\n                                {% endblock %}\n                            </template>\n                        {% endblock %}\n\n                        {% block sw_data_grid_body_cell_actions_menu %}\n                            <sw-context-button\n                                    v-else\n                                    :menu-width=\"contextButtonMenuWidth\"\n                                    class=\"sw-data-grid__actions-menu\"\n                                    aria-label=\"global.sw-data-grid.actionsMenu\"\n                            >\n                                <slot\n                                        name=\"actions\"\n                                        :item=\"item\"\n                                        :item-index=\"itemIndex\"\n                                >\n                                    {% block sw_data_grid_slot_actions %}{% endblock %}\n                                </slot>\n                            </sw-context-button>\n                        {% endblock %}\n\n                        {% block sw_data_grid_body_cell_action_modals %}\n                            <slot\n                                    name=\"action-modals\"\n                                    :item=\"item\"\n                            >\n                                {% block sw_data_grid_slot_action_modals %}{% endblock %}\n                            </slot>\n                        {% endblock %}\n                    </div>\n                {% endblock %}\n            </td>\n        {% endblock %}\n    </tr>\n    <tr class=\"sw-data-grid__child-row\" v-if=\"childItems[item.id] && isItemExpanded(item)\">\n        <td :colspan=\"currentVisibleColumns.length + 3\">\n            <aggro-entity-listing\n                :columns=\"columns\"\n                :items=\"childItems[item.id]\"\n                :repository=\"repository\"\n                :full-page=\"false\"\n                />\n        </td>\n    </tr>\n    </template>\n{% endblock %}","import './aggro-entity-listing.scss'\nimport template from './aggro-entity-listing.html.twig';\n\nexport default {\n    template,\n    props: {\n        groupBy: {\n            type: Array,\n            required: false\n        },\n        childItems: {\n            type: Object,\n            required: false,\n            default: () => ({})\n        }\n    },\n    data: function () {\n        return {\n            expandedItems: {}\n        }\n    },\n    computed: {\n        groupableColumns() {\n            return this.columns.filter(column => column.groupable).map(column => Object.assign({}, column, {label: this.$tc(column.label)}));\n        },\n        currentGroupBy: {\n            get() {\n                if (!this.groupBy) {\n                    return [];\n                }\n\n                return this.groupBy;\n            },\n            set(newValue) {\n                this.$emit('update:groupBy', newValue);\n            },\n        },\n        isGrouped() {\n            return this.groupBy?.length > 0;\n        }\n    },\n    methods: {\n        applyResult(result) {\n            this.$super('applyResult', result);\n            this.expandedItems = {};\n        },\n        renderColumn: function (item, column) {\n            if (this.groupBy?.length) {\n                if (!column.grouping && !column.groupable) {\n                    return '';\n                }\n                for (const group of this.groupBy) {\n                    const aggregationKey = `${group}-${column.property}`;\n                    const aggregation = this.items.aggregations[aggregationKey];\n                    const bucket = aggregation?.buckets?.find(bucket => bucket.key == item[group]);\n                    if (bucket) {\n                        return bucket[column.grouping.name][column.grouping.type]\n                    }\n                }\n            }\n            if (column.renderFunction) {\n                const renderedValue = this.$super('renderColumn', item, column);\n                return column.renderFunction(item, column, renderedValue);\n            }\n            return this.$super('renderColumn', item, column);\n        },\n        isGroupedColumn(column) {\n            return this.groupBy?.some(group => group === column.property);\n        },\n        isSumColumn(column) {\n            return this.isGrouped && column.grouping && column.grouping.type === 'sum';\n        },\n        isItemColumnExpanded(item, column) {\n            return this.expandedItems[item.id] === column.property;\n        },\n        isItemExpanded(item) {\n            return this.expandedItems[item.id]\n        },\n        toggleItemExpand(item, column) {\n            if(this.expandedItems[item.id]) {\n                this.$set(this.expandedItems, item.id, false);\n                this.$emit('item-collapse', item, column);\n            }else{\n                this.$set(this.expandedItems, item.id, column.property);\n                this.$emit('item-expand', item, column);\n            }\n        },\n        getHeaderCellClasses(column, index) {\n            const classes = this.$super('getHeaderCellClasses', column, index);\n            if (this.isGroupedColumn(column)) {\n                classes.push('sw-data-grid__cell--grouped');\n            }else if(this.isGrouped && !column.grouping && !column.groupable) {\n                classes.push('sw-data-grid__cell--disabled');\n            }\n            return classes;\n        }\n    }\n}"],"names":["template","index","column","newValue","_a","result","item","_b","group","aggregationKey","aggregation","bucket","renderedValue","classes"],"mappings":"AAAA,MAAAA,EAAe,qqMCGfC,EAAe,CACX,SAAAD,EACA,MAAO,CACH,QAAS,CACL,KAAM,MACN,SAAU,EACtB,EACQ,WAAY,CACR,KAAM,OACN,SAAU,GACV,QAAS,KAAO,CAAA,EAC5B,CACA,EACI,KAAM,UAAY,CACd,MAAO,CACH,cAAe,CAAA,CAC3B,CACA,EACI,SAAU,CACN,kBAAmB,CACf,OAAO,KAAK,QAAQ,OAAOE,GAAUA,EAAO,SAAS,EAAE,IAAIA,GAAU,OAAO,OAAO,CAAA,EAAIA,EAAQ,CAAC,MAAO,KAAK,IAAIA,EAAO,KAAK,CAAC,CAAC,CAAC,CAC3I,EACQ,eAAgB,CACZ,KAAM,CACF,OAAK,KAAK,QAIH,KAAK,QAHD,CAAA,CAI3B,EACY,IAAIC,EAAU,CACV,KAAK,MAAM,iBAAkBA,CAAQ,CACrD,CACA,EACQ,WAAY,CDrCpB,IAAAC,ECsCY,QAAOA,EAAA,KAAK,UAAL,YAAAA,EAAc,QAAS,CAC1C,CACA,EACI,QAAS,CACL,YAAYC,EAAQ,CAChB,KAAK,OAAO,cAAeA,CAAM,EACjC,KAAK,cAAgB,CAAA,CACjC,EACQ,aAAc,SAAUC,EAAMJ,EAAQ,CD9C9C,IAAAE,EAAAG,EC+CY,IAAIH,EAAA,KAAK,UAAL,MAAAA,EAAc,OAAQ,CACtB,GAAI,CAACF,EAAO,UAAY,CAACA,EAAO,UAC5B,MAAO,GAEX,UAAWM,KAAS,KAAK,QAAS,CAC9B,MAAMC,EAAiB,GAAGD,CAAK,IAAIN,EAAO,QAAQ,GAC5CQ,EAAc,KAAK,MAAM,aAAaD,CAAc,EACpDE,GAASJ,EAAAG,GAAA,YAAAA,EAAa,UAAb,YAAAH,EAAsB,KAAKI,GAAUA,EAAO,KAAOL,EAAKE,CAAK,GAC5E,GAAIG,EACA,OAAOA,EAAOT,EAAO,SAAS,IAAI,EAAEA,EAAO,SAAS,IAAI,CAEhF,CACA,CACY,GAAIA,EAAO,eAAgB,CACvB,MAAMU,EAAgB,KAAK,OAAO,eAAgBN,EAAMJ,CAAM,EAC9D,OAAOA,EAAO,eAAeI,EAAMJ,EAAQU,CAAa,CACxE,CACY,OAAO,KAAK,OAAO,eAAgBN,EAAMJ,CAAM,CAC3D,EACQ,gBAAgBA,EAAQ,CDlEhC,IAAAE,ECmEY,OAAOA,EAAA,KAAK,UAAL,YAAAA,EAAc,KAAKI,GAASA,IAAUN,EAAO,SAChE,EACQ,YAAYA,EAAQ,CAChB,OAAO,KAAK,WAAaA,EAAO,UAAYA,EAAO,SAAS,OAAS,KACjF,EACQ,qBAAqBI,EAAMJ,EAAQ,CAC/B,OAAO,KAAK,cAAcI,EAAK,EAAE,IAAMJ,EAAO,QAC1D,EACQ,eAAeI,EAAM,CACjB,OAAO,KAAK,cAAcA,EAAK,EAAE,CAC7C,EACQ,iBAAiBA,EAAMJ,EAAQ,CACxB,KAAK,cAAcI,EAAK,EAAE,GACzB,KAAK,KAAK,KAAK,cAAeA,EAAK,GAAI,EAAK,EAC5C,KAAK,MAAM,gBAAiBA,EAAMJ,CAAM,IAExC,KAAK,KAAK,KAAK,cAAeI,EAAK,GAAIJ,EAAO,QAAQ,EACtD,KAAK,MAAM,cAAeI,EAAMJ,CAAM,EAEtD,EACQ,qBAAqBA,EAAQD,EAAO,CAChC,MAAMY,EAAU,KAAK,OAAO,uBAAwBX,EAAQD,CAAK,EACjE,OAAI,KAAK,gBAAgBC,CAAM,EAC3BW,EAAQ,KAAK,6BAA6B,EACrC,KAAK,WAAa,CAACX,EAAO,UAAY,CAACA,EAAO,WACnDW,EAAQ,KAAK,8BAA8B,EAExCA,CACnB,CACA,CACA"}